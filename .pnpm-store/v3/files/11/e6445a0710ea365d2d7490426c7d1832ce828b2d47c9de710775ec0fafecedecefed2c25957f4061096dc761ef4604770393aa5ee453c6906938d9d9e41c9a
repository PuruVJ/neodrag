"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var r=require("fs"),n=require("path"),t=e(require("json5")),o=e(require("resolve")),i=e(require("strip-bom"));function s(){return(s=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}function c(e,r){try{var n=e()}catch(e){return r(e)}return n&&n.then?n.then(void 0,r):n}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var u,a=r.promises.readFile,l=r.promises.stat,f=function(e,r){var t=(void 0===r?{}:r).windows,o=((null!=t?t:"win32"===process.platform)?n.win32.parse:n.parse)(e);return s({},o,{isAbsolute:Boolean(o.root),isPackage:!e.startsWith(".")&&!o.root})},v={NotFound:"not-found",InvalidConfig:"invalid-config"},h=function(e){try{return r.statSync(e).isDirectory()}catch(e){return!1}},d=function(e){return Promise.resolve(c((function(){return Promise.resolve(l(e)).then((function(e){return e.isDirectory()}))}),(function(){return!1})))},m=function(e){try{return r.statSync(e).isFile()}catch(e){return!1}},p=function(e){return Promise.resolve(c((function(){return Promise.resolve(l(e)).then((function(e){return e.isFile()}))}),(function(){return!1})))},y=function(e){return m(e)||h(e)},P=function(e){try{return Promise.resolve(p(e)).then((function(r){return!!r||Promise.resolve(d(e)).then((function(e){return!!e&&!0}))}))}catch(e){return Promise.reject(e)}},j=function(e,r){try{return o.sync(e,{basedir:r,extensions:[".json",".js"]})}catch(e){return}},g=function(e,r){return new Promise((function(n,t){o(e,{basedir:r,extensions:[".json",".js"]},(function(e,r){e?t(e):n(r)}))}))},w=function(e){try{var r=t.parse(e);return r&&"object"==typeof r?r:void 0}catch(e){return}},x={Never:"never",Always:"always",Directory:"directory"},b=((u={})[x.Always]=new Map,u[x.Directory]=new Map,u),N=function(e){return!1===e?x.Never:!0===e?x.Always:e},O=function(e){var r=e.searchName,t=e.ignoreExtends;return e.cache===x.Always?r+" - "+t:n.join(e.cwd,r)+" - "+t},S=function(e){return e.cache===x.Always||e.cache===x.Directory?b[x.Always].get(O(e)):void 0},E=function(e,r){(e.cache===x.Always||e.cache===x.Directory)&&b[x.Always].set(O(e),r)};exports.CacheStrategy=x,exports.DEFAULT_SEARCH_NAME="tsconfig.json",exports.TsConfigErrorReason=v,exports.clearCache=function(){for(var e=0,r=Object.values(b);e<r.length;e++)r[e].clear()},exports.tsconfigResolver=function(e){var r=void 0===e?{}:e,t=r.filePath,o=r.cwd,c=void 0===o?process.cwd():o,u=r.cache,l=void 0===u?t?x.Always:x.Never:u,h=r.searchName,m=void 0===h?"tsconfig.json":h,y=r.ignoreExtends,j=void 0!==y&&y;try{var b=N(l),O=S({cwd:c,cache:b,searchName:m,filePath:t,ignoreExtends:j});return O?Promise.resolve(O):Promise.resolve(function(e){var r=e.cwd,t=e.searchName,o=e.filePath,c=e.ignoreExtends;try{return Promise.resolve(function(e,r,t){try{return Promise.resolve(function(e,r){try{var t,o=function(){function r(r){return o||!r?t:n.resolve(t,e)}var o=!t;return o?r(o):Promise.resolve(d(t)).then(r)},i=process.cwd();if(!r)return Promise.resolve();var s=function(){if(r.startsWith("npm:"))return Promise.resolve(g(r.replace("npm:",""),i)).then((function(e){t=e}));t=n.resolve(i,r)}();return Promise.resolve(s&&s.then?s.then(o):o())}catch(e){return Promise.reject(e)}}(r,t)).then((function(t){var o=!1;function i(r){return o?r:Promise.resolve(p(e)).then((function(r){return r?n.resolve(e):Promise.resolve(function e(r){try{var t=n.join(r,"./tsconfig.json");return Promise.resolve(P(t)).then((function(o){if(o)return t;var i=n.join(r,"../");return r===i?void 0:e(i)}))}catch(e){return Promise.reject(e)}}(e)).then((function(e){return e?n.resolve(e):void 0}))}))}if(t)return t;var s=function(){if("tsconfig.json"!==r){var t=n.resolve(e,r);return Promise.resolve(d(t)).then((function(e){var r=e?n.resolve(t,"tsconfig.json"):t;return o=!0,Promise.resolve(p(r)).then((function(e){return e?r:void 0}))}))}}();return s&&s.then?s.then(i):i(s)}))}catch(e){return Promise.reject(e)}}(r,t,o)).then((function(e){if(!e)return{exists:!1,reason:v.NotFound};var r=[];return Promise.resolve(function e(r,t,o){void 0===o&&(o=!1);try{return Promise.resolve(P(r)).then((function(c){if(c)return Promise.resolve(a(r,"utf8")).then((function(c){var u=!1;function a(e){var r,t;if(u)return e;if(null===(r=l)||void 0===r||null===(t=r.compilerOptions)||void 0===t?void 0:t.baseUrl){var o=n.dirname(m);l.compilerOptions.baseUrl=n.join(o,l.compilerOptions.baseUrl)}return s({},l,{},h,{compilerOptions:s({},l.compilerOptions,{},h.compilerOptions)})}var l,v=i(c),h=w(v),m=null==h?void 0:h.extends;if(!h||!m||o)return h;var y=function(){if(f(m).isPackage)return Promise.resolve(g(m)).then((function(r){function o(r){return t.includes(m)?(u=!0,h):(t.push(m),Promise.resolve(e(m,t)).then((function(e){l=null!=e?e:{}})))}var i=r?Promise.resolve(d(r)).then((function(e){var t=function(){if(!e)return Promise.resolve(p(r)).then((function(e){var n=function(){if(!e)return Promise.resolve(p(r+".json")).then((function(e){e&&(m=r+".json")}));m=r}();if(n&&n.then)return n.then((function(){}))}));m=n.join(r,"tsconfig.json")}();if(t&&t.then)return t.then((function(){}))})):(u=!0,h);return i&&i.then?i.then(o):o()}));m.endsWith(".json")||(m+=".json");var o=n.dirname(r),i=n.join(o,m);return t.includes(i)?(u=!0,h):(t.push(i),Promise.resolve(e(i,t)).then((function(e){l=null!=e?e:{}})))}();return y&&y.then?y.then(a):a(y)}))}))}catch(e){return Promise.reject(e)}}(e,r,c)).then((function(n){return n?{exists:!0,path:e,extendedPaths:r,config:n,isCircular:r.includes(e)}:{exists:!1,reason:v.InvalidConfig,path:e}}))}))}catch(e){return Promise.reject(e)}}({cwd:c,searchName:m,filePath:t,ignoreExtends:j})).then((function(e){return E({cwd:c,cache:b,searchName:m,filePath:t,ignoreExtends:j},e),e}))}catch(e){return Promise.reject(e)}},exports.tsconfigResolverSync=function(e){var t=void 0===e?{}:e,o=t.filePath,c=t.cwd,u=void 0===c?process.cwd():c,a=t.cache,l=t.searchName,d=void 0===l?"tsconfig.json":l,p=t.ignoreExtends,P=void 0!==p&&p,g=N(void 0===a?o?x.Always:x.Never:a),b=S({cwd:u,cache:g,searchName:d,filePath:o,ignoreExtends:P});if(b)return b;var O=function(e){var t=e.ignoreExtends,o=function(e,r,t){var o=function(e,r){var t,o=process.cwd();if(r)return(t=r.startsWith("npm:")?j(r.replace("npm:",""),o):n.resolve(o,r))&&h(t)?n.resolve(t,e):t}(r,t);if(o)return o;if("tsconfig.json"!==r){var i=n.resolve(e,r),s=h(i)?n.resolve(i,"tsconfig.json"):i;return m(s)?s:void 0}if(m(e))return n.resolve(e);var c=function e(r){var t=n.join(r,"./tsconfig.json");if(y(t))return t;var o=n.join(r,"../");return r!==o?e(o):void 0}(e);return c?n.resolve(c):void 0}(e.cwd,e.searchName,e.filePath);if(!o)return{exists:!1,reason:v.NotFound};var c=[],u=function e(t,o,c){var u,a;if(void 0===c&&(c=!1),y(t)){var l,v=r.readFileSync(t,"utf8"),d=i(v),p=w(d),P=null==p?void 0:p.extends;if(!p||!P||c)return p;if(f(P).isPackage){var g,x=j(P);if(!x)return p;if(h(x)?P=n.join(x,"tsconfig.json"):m(x)?P=x:m(x+".json")&&(P=x+".json"),o.includes(P))return p;o.push(P),l=null!==(g=e(P,o))&&void 0!==g?g:{}}else{var b;P.endsWith(".json")||(P+=".json");var N=n.dirname(t),O=n.join(N,P);if(o.includes(O))return p;o.push(O),l=null!==(b=e(O,o))&&void 0!==b?b:{}}if(null===(u=l)||void 0===u||null===(a=u.compilerOptions)||void 0===a?void 0:a.baseUrl){var S=n.dirname(P);l.compilerOptions.baseUrl=n.join(S,l.compilerOptions.baseUrl)}return s({},l,{},p,{compilerOptions:s({},l.compilerOptions,{},p.compilerOptions)})}}(o,c,t);return u?{exists:!0,path:o,extendedPaths:c,config:u,isCircular:c.includes(o)}:{exists:!1,reason:v.InvalidConfig,path:o}}({cwd:u,searchName:d,filePath:o,ignoreExtends:P});return E({cwd:u,cache:g,searchName:d,filePath:o,ignoreExtends:P},O),O};
//# sourceMappingURL=tsconfig-resolver.cjs.production.min.js.map
