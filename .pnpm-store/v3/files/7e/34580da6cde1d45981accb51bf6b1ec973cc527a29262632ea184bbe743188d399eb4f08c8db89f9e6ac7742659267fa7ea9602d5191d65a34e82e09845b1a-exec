"use strict";var N=require("path"),S=require("fs"),y=require("module"),r=require("@esbuild-kit/core-utils"),i=require("get-tsconfig");function f(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var _=f(N),P=f(S),d=f(y);const E=/^\.{0,2}\//,O=/\.[cm]?tsx?$/,b=`${_.default.sep}node_modules${_.default.sep}`,l=process.env.ESBK_TSCONFIG_PATH?{path:process.env.ESBK_TSCONFIG_PATH,config:i.parseTsconfig(process.env.ESBK_TSCONFIG_PATH)}:i.getTsconfig(),j=l==null?void 0:l.config,v=l&&i.createPathsMatcher(l),h=r.installSourceMapSupport(),x=r.compareNodeVersion([13,2,0])>=0||r.compareNodeVersion([12,20,0])>=0&&r.compareNodeVersion([13,0,0])<0;function T(e,s){process.send&&process.send({type:"dependency",path:s});let t=P.default.readFileSync(s,"utf8");if(s.endsWith(".cjs")&&x){const o=r.transformDynamicImport(s,t);o&&(t=h(o,s))}else{const o=r.transformSync(t,s,{tsconfigRaw:j});t=h(o,s)}e._compile(t,s)}const g=d.default._extensions;[".js",".ts",".tsx",".jsx"].forEach(e=>{g[e]=T}),Object.defineProperty(g,".mjs",{value:T,enumerable:!1});const A=r.compareNodeVersion([16,0,0])>=0||r.compareNodeVersion([14,18,0])>=0,u=d.default._resolveFilename;d.default._resolveFilename=function(e,s,t,o){var n;if(!A&&e.startsWith("node:")&&(e=e.slice(5)),v&&!E.test(e)&&!((n=s==null?void 0:s.filename)!=null&&n.includes(b))){const a=v(e);for(const p of a){const m=F.call(this,p,s,t,o);if(m)return m;try{return u.call(this,p,s,t,o)}catch{}}}const c=F.call(this,e,s,t,o);return c||u.call(this,e,s,t,o)};function F(e,s,t,o){const n=r.resolveTsPath(e);if(s&&O.test(s.filename)&&n)try{return u.call(this,n,s,t,o)}catch(c){const{code:a}=c;if(a!=="MODULE_NOT_FOUND"&&a!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw c}}
