---
import MainDocsLayout from '$layouts/MainDocsLayout.astro';
import type { GetStaticPaths } from 'astro';
import { getCollection, render } from 'astro:content';

const { guide } = Astro.params;

const guide_collection = await getCollection('guide');
const guide_entry = guide_collection.find((f) => f.id.includes(guide));

console.log(guide_entry);

if (!guide_entry) {
	return;
}

const { Content, headings } = await render(guide_entry);

export const getStaticPaths = (async () => {
	const guide_collection = await getCollection('guide');
	console.log(guide_collection.map((f) => f.id));
	return guide_collection.map((f) => ({
		params: { guide: f.id.replace(/\d{2}-(.+)\/page/, '$1') },
	}));
}) satisfies GetStaticPaths;
---

<MainDocsLayout {...guide_entry.data} headings={headings}>
	<Content />
</MainDocsLayout>
